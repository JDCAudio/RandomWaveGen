# Building the Code

Navigate to the [Stray](/Stray/) folder. Select the version of the project you want to build ([Most Recent](/Stray/1_2/)) and navigate to that directory. Each version's directory contains the following:
* FaustDSP
  * A single Faust ([.dsp](/Stray/1_2/FaustDSP/stray_1_2.dsp)) file 
* JuceProject
  * Source code ([.cpp](/Stray/1_2/JuceProject/FaustPluginProcessor.cpp)) and a Juce project ([.jucer](/Stray/1_2/JuceProject/stray_1_2.jucer)) file
* builds
  * Contains Standalone ([.app](/Stray/1_2/builds/stray_1_2.app)) and VST ([.vst3](/Stray/1_2/builds/stray_1_2.vst3)) 
  * Currently the provided files are exclusive to Mac. If you wish to use the VST on a Windows or Linux machine, follow the "Building the Juce Project" instructions below
    
## Running the Faust (.dsp) file
Faust can be used in a variety of ways ([Faust Downloads](https://faust.grame.fr/downloads/)), but the easiest and fastest way is through the [online IDE](https://faustide.grame.fr)
1. Open the [IDE](https://faustide.grame.fr)
   * Chrome is currently the only browser that supports the MIDI functionality 
2. Upload [stray_X_X.dsp](/Stray/1_2/FaustDSP/stray_1_2.dsp)
3. Click Run to compile the code

That's all that is required to run the Faust project! Any connected midi controllers can be chosen from the menu on the top right and the instrument is fully usable within the browser. 

## Building the Juce Project
1. Download BOTH the [.cpp](/Stray/1_2/JuceProject/FaustPluginProcessor.cpp) and [.jucer](/Stray/1_2/JuceProject/stray_1_2.jucer) file, place them in the same folder. 
2. Download [JUCE](https://juce.com/get-juce)
   * Place your JUCE folder in your Home Directory 
3. Open Projucer
4. Setting up Global Paths
   1. On the top left of your screen, click on "Projucer"
   2. From the drop-down menu, select "Global Paths..."
   3. Ensure that your Path to JUCE and JUCE Modules is correct
      * Ex: On my system:
        * Path To JUCE: `/Users/jclark/JUCE`
        * Path To JUCE Modules: `/Users/jclark/JUCE/modules`
5. Click "Open Existing Project" and select [stray_X_X.jucer](/Stray/1_2/JuceProject/stray_1_2.jucer)
6. Navigate to the Modules tab and ensure that for every module "Use Global Path" is selected
7. Select your Exporter and click Open in IDE
8. Choose your build settings, and run the code
9. The auto-generated code does throw some warnings, but the build should succeed, and if you have selected the standalone app version, a window will open for you. 

## How to get from Faust to Juce
The process of converting the Faust project to Juce is actually quite straightforward, however there is no up-to-date documentation on the process.

When set up properly, the code generated by Faust will be entirely functional without the need of any edits. 

1. Open Faust's [Online IDE](https://faustide.grame.fr)
2. Click on the Export button (Truck icon below the save button on the left side of the screen)
3. Select Juce as the Platform 
4. Select plug-in-midi-poly-16 as the Architecture (Or, if this is for a different project, whatever architecture seems appropriate)
5. Click Compile, and then Click Download once the button appears
6. Un-zip the downloaded file and place the folder in your desired location
   * This zip file will contain both a FaustPluginProcessor.cpp file and a .jucer file for the project
7. Open the .jucer File in Projucer
8. Projucer will likely notify you that some of the chosen exporters are no longer available. Simply remove these, and any others that you are not planning on using. 
9. Ensure that JUCE's global paths are set correctly (see step 4 in "Building the Juce Project")
10. Navigate to the Modules tab, click on every individual module and select the "Use Global Path" option
11. In the settings, scroll to Plug-in Formats and ensure that only VST3 and Standalone are selected
12. For Stray, multiple parameter names would be the same when shortened to the AAX format. I am not currently planning on supporting this format, but it does throw some errors in Juce. To avoid this:
    1. Click on the settings icon above the file explorer
    2. Scroll down until you see Preprocessor Definitions 
    3. Add "JUCE_DISABLE_CAUTIOUS_PARAMETER_ID_CHECKING" to the preprocessor definitions 
13. Select your Exporter and click open in IDE
14. Choose your build settings, and run the code
15. The auto-generated code does throw some warnings, but the build should succeed, and if you have selected the standalone app version, a window will open for you. .vst3 and .app files can be found through the created "builds" folder within your project. 
